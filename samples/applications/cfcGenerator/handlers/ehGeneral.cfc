<!-----------------------------------------------------------------------Author 	 :	Your NameDate     :	September 25, 2005Description : 				This is a ColdBox event handler.Please note that the extends needs to point to the eventhandler.cfcin the ColdBox system directory.extends = coldbox.system.eventhandler	-----------------------------------------------------------------------><cfcomponent name="ehGeneral" extends="coldbox.system.eventhandler">	<!------------------------------------------- CONSTRUCTOR (If Needed) -------------------------------------------><!------------------------------------------- PUBLIC ------------------------------------------->		<cffunction name="onAppInit" access="public" returntype="void" output="false">		<cfargument name="Context" type="coldbox.system.beans.requestContext">		<cfset var MyService = getSetting("AppMapping") & ".model.GeneratorService">		<cfset application.GService = CreateObject("component",MyService).init(getSetting("adminpass"))>	</cffunction>		<cffunction name="dspHome" access="public" returntype="void" output="false">		<cfargument name="Context" type="coldbox.system.beans.requestContext">		<cfset var rc = Context.getCollection()>		<!--- EXIT HANDLERS: --->		<cfset rc.xehProcessDSN = "ehGeneral.doProcessDSN">		<!--- Get DSN's --->		<cfset rc.DSNs = getDSNs() />		<!--- Set view to render --->		<cfset Context.setView("vwHome")>	</cffunction>		<cffunction name="doProcessDSN" access="public" returntype="void" output="false">		<cfargument name="Context" type="coldbox.system.beans.requestContext">		<cfset var thisDSN = "" />		<cfset var rc = Context.getCollection()>		<!--- EXIT HANDLERS: --->		<cfset rc.xehGenerate = "ehGeneral.doGenerate">				<!--- Get Setup --->		<cfset rc.DSNs = getDSNs() />		<cfset rc.dbType = getDBType()>		<cfset rc.tables = getTables()>				<!--- Param Values --->		<cfset paramComponents()>				<!--- Set View --->		<cfset Context.setView("vwComponents")>			</cffunction>		<cffunction name="doGenerate" access="public" returntype="void" output="false">		<cfargument name="Context" type="coldbox.system.beans.requestContext">		<cfset var rc = Context.getCollection()>		<!--- EXIT HANDLERS: --->		<cfset rc.xehGenerate = "ehGeneral.doGenerate">				<!--- Get Setup --->		<cfset rc.DSNs = getDSNs() />		<cfset rc.dbType = getDBType()>		<cfset rc.tables = getTables()>				<!--- Get Table XML --->		<cfset application.GService.getModel(rc.dbType).setTable(Context.getValue("table")) />		<cfset application.GService.getModel(rc.dbType).setComponentPath(Context.getValue("componentPath")) />		<cfset rc.xmlTable = application.GService.getModel(rc.dbType).getTableXML() />				<!--- Get Generated CFC's --->		<cfset application.GService.getModel("xsl").configure(Context.getValue("dsn"),getSetting("xslBasePath")) />		<!--- get an array containing the generated code --->		<cfset rc.arrComponents = application.GService.getModel("xsl").getComponents(rc.xmlTable) />				<!--- Set the View --->		<cfset Context.setView("vwGeneration")>	</cffunction>		<!------------------------------------------- PRIVATE REUSABLE EVENTS ------------------------------------------->	<cffunction name="getDSNs" access="private" returntype="struct" output="false">		<cfreturn application.GService.getModel("adminAPIService").getdatasources() />	</cffunction>		<cffunction name="getDBType" access="private" returntype="string" output="false">		<cfset var rc = controller.getRequestService().getContext().getCollection()>		<cfset var thisDSN = rc.DSNs[rc.dsn] />		<cfif thisDSN.driver eq "MSSQLServer"  or thisDSN.class contains "MSSQLServer">			<cfreturn "mssql" />		<cfelseif thisDSN.driver contains "mySQL" or thisDSN.class contains "mySQL">			<cfreturn "mysql" />		<cfelseif thisDSN.driver contains "Oracle" or thisDSN.class contains "Oracle">			<cfreturn "Oracle" />		</cfif>			</cffunction>		<cffunction name="getTables" access="private" returntype="query" output="false">		<cfset var rc = controller.getRequestService().getContext().getCollection()>		<cfset application.GService.getModel(rc.dbType).setDSN(rc.dsn)>		<cfreturn application.GService.getModel(rc.dbType).getTables() />	</cffunction>		<cffunction name="paramComponents" access="private" returntype="void" output="false">		<cfset var requestContext = controller.getRequestService().getContext()>		<cfset Context.paramValue("table", "")>		<cfset Context.paramValue("componentPath", "")>		<cfset Context.paramValue("generateService", "0")>		<cfset Context.paramValue("generateTO", "0")>		<cfset Context.paramValue("generateColdspringXML", "0")>	</cffunction>		</cfcomponent>